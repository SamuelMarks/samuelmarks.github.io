ml_switcheroo.discovery.scaffolder
==================================

.. py:module:: ml_switcheroo.discovery.scaffolder

.. autoapi-nested-parse::

   Scaffolding Tool for Knowledge Base Discovery.

   This module provides the `Scaffolder` class, which inspects installed
   libraries (Torch, JAX, etc.) and aligns them against the Specification-Guided
   Knowledge Base.

   It prioritizes matching discovered APIs against ingested Specs (ONNX, Array API)
   before falling back to structural heuristics.

   Major Updates:
   - Feature: Signature Analysis during Fuzzy Matching. The discovery process now
     penalizes or rejects matches if argument counts (arity) diverge significantly,
     preventing false positives like linking unary `min(x)` to multi-arg `min(x, y)`.
   - Feature 07: Robust Varargs Support. If a function accepts `*args`, it is treated
     as having flexible arity, skipping penalties for count mismatches.



Classes
-------

.. autoapisummary::

   ml_switcheroo.discovery.scaffolder.Scaffolder


Module Contents
---------------

.. py:class:: Scaffolder(semantics: Optional[ml_switcheroo.semantics.manager.SemanticsManager] = None, similarity_threshold: float = 0.8, arity_penalty: float = 0.3)

   Automated discovery tool that aligns framework APIs.

   .. attribute:: inspector

      Tool to extract function signatures.

      :type: ApiInspector

   .. attribute:: console

      Rich console for output.

      :type: Console

   .. attribute:: semantics

      The knowledge base manager.

      :type: SemanticsManager

   .. attribute:: similarity_threshold

      Cutoff for fuzzy matching (0.0 - 1.0).

      :type: float

   .. attribute:: arity_penalty

      Penalty subtracted from similarity score for mismatched arity.

      :type: float


   .. py:attribute:: inspector


   .. py:attribute:: console


   .. py:attribute:: semantics


   .. py:attribute:: similarity_threshold
      :value: 0.8



   .. py:attribute:: arity_penalty
      :value: 0.3



   .. py:attribute:: tier_a_math
      :type:  Dict[str, Any]


   .. py:attribute:: tier_b_neural
      :type:  Dict[str, Any]


   .. py:attribute:: tier_c_extras
      :type:  Dict[str, Any]


   .. py:method:: scaffold(frameworks: List[str], output_dir: pathlib.Path)

      Main entry point. Scans frameworks and builds/updates JSON mappings.

      Discovery Strategy:
      1. **Spec Validation**: Checks if discovered API matches a specific
         Abstract Operator already defined in the Knowledge Base (e.g., from ONNX).
      2. **Heuristic Fallback**: If no spec match, uses naming/path conventions
         (e.g., `.nn.` path implies Neural).

      :param frameworks: List of package names (e.g. ['torch', 'jax']).
      :param output_dir: Directory to save generated JSON files.



