ml_switcheroo.core.engine
=========================

.. py:module:: ml_switcheroo.core.engine

.. autoapi-nested-parse::

   Orchestration Engine for AST Transformations.

   This module provides the ``ASTEngine``, the primary driver for the transpilation process.
   It coordinates the various analysis and transformation passes required to convert code
   from a source framework to a target framework.

   Pipeline:

   1.  **Ingestion**: Adapter Hooks (LaTeX) or Standard Parsing (Python/MLIR/TikZ).
   2.  **Emission**: Adapter Hooks (LaTeX) or Standard Emission (Python/MLIR/TikZ).
   3.  **Analysis**: Symbol Table Inference, Purity, Lifecycle, Dependency checks.
   4.  **Transformation**: Rewriting via PivotRewriter.
   5.  **Refinement**: Import Fixing and Linting.



Classes
-------

.. autoapisummary::

   ml_switcheroo.core.engine.ASTEngine


Module Contents
---------------

.. py:class:: ASTEngine(semantics: Optional[ml_switcheroo.semantics.manager.SemanticsManager] = None, config: Optional[ml_switcheroo.config.RuntimeConfig] = None, source: Optional[str] = None, target: Optional[str] = None, strict_mode: bool = False, enable_fusion: bool = False, plugin_config: Optional[Dict[str, Any]] = None, intermediate: Optional[str] = None)

   The main compilation unit.

   Orchestrates parsing, analysis, transformation, and code generation.


   .. py:attribute:: semantics


   .. py:attribute:: source


   .. py:attribute:: target


   .. py:attribute:: strict_mode


   .. py:attribute:: intermediate


   .. py:attribute:: source_adapter


   .. py:attribute:: target_adapter


   .. py:method:: parse(code: str) -> libcst.Module

      Parses Python source code into a LibCST module.

      :param code: Source code string.

      :returns: A parsed CST object.



   .. py:method:: to_source(tree: libcst.Module) -> str

      Converts a LibCST module back to source code string.

      :param tree: The modified CST module.

      :returns: The generated Python code.



   .. py:method:: run(code: str) -> ml_switcheroo.core.conversion_result.ConversionResult

      Executes the full transpilation pipeline.

      Steps:

      1.  **Ingestion**: Parse source (Python/MLIR/LaTeX) to AST.
      2.  **Short-Circuit**: If target is non-Python (MLIR/TikZ/Latex), emit immediately.
      3.  **Analysis**:
          - Run Symbol Table Analyzer for type inference.
          - Run Purity, Lifecycle, and Dependency checks.
      4.  **Transformation**: Rewriting via PivotRewriter.
      5.  **Refinement**: Run `ImportFixer` and `StructuralLinter` to clean results.

      :param code: The source code string to transpile.

      :returns: A `ConversionResult` containing the output code, errors, and execution trace.



