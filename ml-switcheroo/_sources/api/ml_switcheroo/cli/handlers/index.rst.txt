ml_switcheroo.cli.handlers
==========================

.. py:module:: ml_switcheroo.cli.handlers


Submodules
----------

.. toctree::
   :maxdepth: 1

   /api/ml_switcheroo/cli/handlers/convert/index
   /api/ml_switcheroo/cli/handlers/dev/index
   /api/ml_switcheroo/cli/handlers/discovery/index
   /api/ml_switcheroo/cli/handlers/verify/index


Functions
---------

.. autoapisummary::

   ml_switcheroo.cli.handlers.handle_convert
   ml_switcheroo.cli.handlers.handle_snapshot
   ml_switcheroo.cli.handlers.handle_scaffold
   ml_switcheroo.cli.handlers.handle_import_spec
   ml_switcheroo.cli.handlers.handle_sync
   ml_switcheroo.cli.handlers.handle_sync_standards
   ml_switcheroo.cli.handlers.handle_wizard
   ml_switcheroo.cli.handlers.handle_harvest
   ml_switcheroo.cli.handlers.handle_ci
   ml_switcheroo.cli.handlers.handle_matrix
   ml_switcheroo.cli.handlers.handle_docs
   ml_switcheroo.cli.handlers.handle_gen_tests


Package Contents
----------------

.. py:function:: handle_convert(input_path: pathlib.Path, output_path: Optional[pathlib.Path], source: Optional[str], target: Optional[str], verify: bool, strict: Optional[bool], plugin_settings: Dict[str, Any], json_trace_path: Optional[pathlib.Path] = None) -> int

   Handles the 'convert' command execution.

   Orchestrates the loading of configuration, initialization of the semantic
   knowledge base, and the execution of the transpilation engine on files or directories.

   :param input_path: Path to the source file or directory to convert.
   :param output_path: Path where generated code should be saved.
   :param source: Override for source framework (e.g. 'torch').
   :param target: Override for target framework (e.g. 'jax').
   :param verify: If True, generates and runs a verification harness test immediately.
   :param strict: If True, enforces strict strict_mode on the Engine.
   :param plugin_settings: Dictionary of specific plugin configuration flags.
   :param json_trace_path: Optional path to dump execution trace JSON.

   :returns: Exit code (0 for success, 1 for failure).
   :rtype: int


.. py:function:: handle_snapshot(out_dir: Optional[pathlib.Path]) -> int

   Handles the 'snapshot' command.

   Scans installed frameworks and dumps their API signatures to JSON files.
   These snapshots allow the engine to operate in "Ghost Mode" (e.g., in WebAssembly)
   without requiring the heavy frameworks to be installed.

   :param out_dir: Optional custom output directory. Defaults to package/snapshots.

   :returns: Exit code.
   :rtype: int


.. py:function:: handle_scaffold(frameworks: list[str], out_dir: pathlib.Path) -> int

   Handles the 'scaffold' command.

   Automatically generates mapping skeletons based on fuzzy matching between
   framework APIs and the semantic spec rules.

   :param frameworks: List of framework names to scaffold.
   :param out_dir: The root directory for generating the knowledge base.

   :returns: Exit code.
   :rtype: int


.. py:function:: handle_import_spec(target: pathlib.Path) -> int

   Handles the 'import-spec' command.

   Parses upstream standards documentation or stubs and merges the definitions
   into the local semantics Hub.

   Supported Targets:
   1. 'internal': Loads the Internal Golden Sets for Optimizers/Vision/State.
   2. '*.md': Parses ONNX Markdown specifications.
   3. Directory: Parses Python Array API stub files.

   :param target: The file, directory, or keyword to import.

   :returns: Exit code.
   :rtype: int


.. py:function:: handle_sync(framework: str) -> int

   Handles the 'sync' command.

   Links the Abstract Standards (Hub) to the concrete implementation in a
   specific framework. This process involves:
   1.  Reading the Specs from `semantics/`.
   2.  Introspecting the installed framework to find matching APIs.
   3.  Applying Adapter-specific manual wiring (plugins, templates).
   4.  Writing the results to the Snapshot Overlay (`snapshots/{fw}_mappings.json`).

   :param framework: The framework key to sync (e.g. 'torch', 'jax').

   :returns: Exit code.
   :rtype: int


.. py:function:: handle_sync_standards(categories: List[str], frameworks: Optional[List[str]], dry_run: bool) -> int

   Handles 'sync-standards' command.

   Invokes the Consensus Engine to automatically discover new Abstract Operations
   by finding commonalities across multiple framework API surfaces.

   :param categories: List of API categories to scan (e.g. 'loss', 'layer').
   :param frameworks: List of frameworks to use for consensus (default: all).
   :param dry_run: If True, prints candidates without saving.

   :returns: Exit code.
   :rtype: int


.. py:function:: handle_wizard(package: str) -> int

   Handles the 'wizard' command for interactive mapping discovery.

   :param package: The name of the python package to inspect (e.g., 'torch').

   :returns: Exit code (0 for success).
   :rtype: int


.. py:function:: handle_harvest(path: pathlib.Path, target: str, dry_run: bool) -> int

   Handles the 'harvest' command to learn mappings from manual tests.

   :param path: File or directory containing python test files.
   :param target: The framework target used in the tests (e.g., 'jax').
   :param dry_run: If True, prints changes without writing to disk.

   :returns: Exit code (0 for success, 1 for path errors).
   :rtype: int


.. py:function:: handle_ci(update_readme: bool, readme_path: pathlib.Path, json_report: Optional[pathlib.Path]) -> int

   Handles 'ci' command.


.. py:function:: handle_matrix() -> int

   Handles 'matrix' command.


.. py:function:: handle_docs(source: str, target: str, out_path: pathlib.Path) -> int

   Handles 'gen-docs' command.


.. py:function:: handle_gen_tests(out: pathlib.Path) -> int

   Handles 'gen-tests' command.


