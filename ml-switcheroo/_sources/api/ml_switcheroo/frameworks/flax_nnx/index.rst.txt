ml_switcheroo.frameworks.flax_nnx
=================================

.. py:module:: ml_switcheroo.frameworks.flax_nnx

.. autoapi-nested-parse::

   Flax NNX Framework Adapter (Level 2).

   Extends the JAX core adapter with Flax's Neural Network Extensions (nnx).

   - Uses dynamic or snapshot mode discovery.
   - Provides clear import alias for `from flax import nnx`.
   - Defines the correct base class `flax.nnx.Module`.
   - Wires important plugins and structural traits.



Attributes
----------

.. autoapisummary::

   ml_switcheroo.frameworks.flax_nnx.flax_nnx


Classes
-------

.. autoapisummary::

   ml_switcheroo.frameworks.flax_nnx.FlaxNNXAdapter


Module Contents
---------------

.. py:data:: flax_nnx
   :value: None


.. py:class:: FlaxNNXAdapter

   Bases: :py:obj:`ml_switcheroo.frameworks.common.jax_stack.JAXStackMixin`


   Adapter class for Flax NNX.

   Inherits from JAXStackMixin for core math/optax behavior and adds:
   - Explicit neural network layers and activations.
   - Correct import aliasing for `from flax import nnx`.
   - Structural traits targeting Flax's nnx Module base.


   .. py:attribute:: display_name
      :type:  str
      :value: 'Flax NNX'



   .. py:attribute:: inherits_from
      :type:  str
      :value: 'jax'



   .. py:attribute:: ui_priority
      :type:  int
      :value: 15



   .. py:method:: collect_api(category: ml_switcheroo.frameworks.base.StandardCategory) -> List[ml_switcheroo.frameworks.base.GhostRef]

      Collect API definitions for discovery.

      :param category: The API category (layer, activation, etc.)
      :type category: StandardCategory

      :returns: List of found API references.
      :rtype: List[GhostRef]



   .. py:property:: search_modules
      :type: List[str]


      Modules to scan for discovery.

      :returns: Ordered list of module names.
      :rtype: List[str]


   .. py:property:: import_alias
      :type: Tuple[str, str]


      Returns the base package and alias to guide import injection.
      Used by ImportFixer to map `flax.nnx` root usage to `nnx` alias.

      :returns: (root_package, alias)
      :rtype: Tuple[str, str]


   .. py:property:: import_namespaces
      :type: Dict[str, ml_switcheroo.frameworks.base.ImportConfig]


      Declares self namespaces with tiers and recommended aliases.

      :returns: Mapping of package paths to configs.
      :rtype: Dict[str, ImportConfig]


   .. py:property:: discovery_heuristics
      :type: Dict[str, List[str]]


      Regex patterns for heuristic category assignment during scaffolding.

      :returns: Mapping of tiers to regex lists.
      :rtype: Dict[str, List[str]]


   .. py:property:: test_config
      :type: Dict[str, str]


      Test code templates extended from JAX core.

      :returns: Test harness code snippets/templates.
      :rtype: Dict[str, str]


   .. py:property:: harness_imports
      :type: List[str]


      Imports for Harness generation.


   .. py:method:: get_harness_init_code() -> str

      Logic to create Flax NNX Rngs.



   .. py:property:: supported_tiers
      :type: List[ml_switcheroo.enums.SemanticTier]


      Semantic tiers supported by this adapter.

      :returns: Supported tiers.
      :rtype: List[SemanticTier]


   .. py:property:: declared_magic_args
      :type: List[str]



   .. py:property:: structural_traits
      :type: ml_switcheroo.frameworks.base.StructuralTraits


      Structural rewriting traits guiding the pivot rewriter.
      Explicitly defines `flax.nnx.Module` to ensure clean inheritance rewriting
      without internal submodule leakage.

      :returns: Configuration of base class, methods, and injections.
      :rtype: StructuralTraits


   .. py:property:: plugin_traits
      :type: ml_switcheroo.frameworks.base.PluginTraits


      Plugin capabilities indicating required behaviors in the target framework.

      :returns: Flags controlling plugin execution.
      :rtype: PluginTraits


   .. py:property:: definitions
      :type: Dict[str, ml_switcheroo.frameworks.base.StandardMap]


      Static standard operation definitions specific to Flax NNX.

      :returns: Mapping of standard op names to framework implementations.
      :rtype: Dict[str, StandardMap]


   .. py:method:: convert(data: Any) -> Any

      Converts generic data to framework-specific Pytree/arrays.

      :returns: Converted data tailored to JAX/Flax ecosystem.



   .. py:method:: apply_wiring(snapshot: Dict[str, Any]) -> None

      Applies manual wiring and modifies the snapshot to alias 'flax.nnx.' to 'nnx.'.

      Adds plugin wiring for key interface methods.

      :param snapshot: The mapping snapshot dictionary.
      :type snapshot: Dict[str, Any]



   .. py:method:: get_example_code() -> str
      :classmethod:


      Example neural network showcasing Flax NNX idiomatic usage.

      :returns: Example source code string.
      :rtype: str



   .. py:method:: get_tiered_examples() -> Dict[str, str]

      Provides tier-specific example usages for documentation and tests.

      :returns: Dictionary mapping tier names to code snippets.
      :rtype: Dict[str, str]



