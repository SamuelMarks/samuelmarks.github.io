ml_switcheroo.generated_tests.runtime
=====================================

.. py:module:: ml_switcheroo.generated_tests.runtime

.. autoapi-nested-parse::

   Runtime helpers for generated verification tests.

   This module contains the reference implementation of `verify_results`,
   which provides a robust, recursive comparison between arbitrary data structures.

   It also provides the `ensure_determinism` fixture to seed RNGs across frameworks.



Functions
---------

.. autoapisummary::

   ml_switcheroo.generated_tests.runtime.ensure_determinism
   ml_switcheroo.generated_tests.runtime.verify_results


Module Contents
---------------

.. py:function:: ensure_determinism()

   Auto-injects fixed seeds for reproducibility at the start of every test.
   Covers Python random, NumPy, Torch, TensorFlow, and MLX.


.. py:function:: verify_results(ref, val, rtol=0.001, atol=0.001, exact=False)

   Cross-framework comparison helper.

   Recursively compares data structures (Lists, Dicts, Tuples).
   If 'exact' is True, enforces strict equality for all types (np.array_equal).
   If 'exact' is False (default), applies fuzzy matching (np.allclose) for floats/complex.


