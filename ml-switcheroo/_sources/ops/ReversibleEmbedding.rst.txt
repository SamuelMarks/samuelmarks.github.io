ReversibleEmbedding
===================

An embedding layer which can project backwards to the input dim.

This layer is an extension of `keras.layers.Embedding` for language models.
This layer can be called "in reverse" with `reverse=True`, in which case the
layer will linearly project from `output_dim` back to `input_dim`.

By default, the reverse projection will use the transpose of the
`embeddings` weights to project to `input_dim` (weights are "tied"). If
`tie_weights=False`, the model will use a separate, trainable variable for
reverse projection.

This layer has no bias terms.

Args:
    input_dim: Integer. Size of the vocabulary,
        i.e. maximum integer index + 1.
    output_dim: Integer. Dimension of the dense embedding.
    tie_weights: Boolean, whether or not the matrix for embedding and
        the matrix for the `reverse` projection should share the same
        weights.
    embeddings_initializer: Initializer for the `embeddings`
        matrix (see `keras.initializers`).
    embeddings_regularizer: Regularizer function applied to
        the `embeddings` matrix (see `keras.regularizers`).
    embeddings_constraint: Constraint function applied to
        the `embeddings` matrix (see `keras.constraints`).
    mask_zero: Boolean, whether or not the input value 0 is a special
        "padding" value that should be masked out.
    reverse_dtype: The dtype for the reverse projection computation.
        Defaults to the `compute_dtype` of the layer.
    logit_soft_cap: If `logit_soft_cap` is set and `reverse=True`, the
        output logits will be scaled by
        `tanh(logits / logit_soft_cap) * logit_soft_cap`. This narrows the
        range of output logits and can improve training.
    **kwargs: other keyword arguments passed to `keras.layers.Embedding`,
        including `name`, `trainable`, `dtype` etc.

Call arguments:
    inputs: The tensor inputs to the layer.
    reverse: Boolean. If `True` the layer will perform a linear projection
        from `output_dim` to `input_dim`, instead of a normal embedding
        call. Default to `False`.

Example:
```python
batch_size = 16
vocab_size = 100
hidden_dim = 32
seq_length = 50

# Generate random inputs.
token_ids = np.random.randint(vocab_size, size=(batch_size, seq_length))

embedding = keras.layers.ReversibleEmbedding(vocab_size, hidden_dim)
# Embed tokens to shape `(batch_size, seq_length, hidden_dim)`.
hidden_states = embedding(token_ids)
# Project hidden states to shape `(batch_size, seq_length, vocab_size)`.
logits = embedding(hidden_states, reverse=True)
```

References:
- [Vaswani et al., 2017](https://arxiv.org/abs/1706.03762)
- [Press and Wolf, 2016](https://arxiv.org/abs/1608.05859)

**Abstract Signature:**

``ReversibleEmbedding(input_dim, output_dim, tie_weights, embeddings_initializer, embeddings_regularizer, embeddings_constraint, mask_zero, reverse_dtype, logit_soft_cap, kwargs)``

.. raw:: html

 
    <div class="op-tabs-container"> 
      <div class="op-tabs-nav"> 
        <button class="op-tab-btn active" onclick="openOpTab(event, 'Keras_0')">Keras</button><button class="op-tab-btn " onclick="openOpTab(event, 'TensorFlow_1')">TensorFlow</button> 
      </div> 
      <div class="op-tabs-content"> 
        <div id="Keras_0" class="op-tab-pane active"><h4>Keras</h4><div class="op-detail-row"><span class="label">API:</span> <code>keras.layers.ReversibleEmbedding</code></div><div class="op-detail-row"><span class="label">Strategy:</span> <span>Direct Mapping</span></div><div class="op-detail-row"><a href="https://keras.io/search.html?q=keras.layers.ReversibleEmbedding" target="_blank" class="op-doc-link">Official Docs ↗</a></div></div><div id="TensorFlow_1" class="op-tab-pane "><h4>TensorFlow</h4><div class="op-detail-row"><span class="label">API:</span> <code>keras.layers.ReversibleEmbedding</code></div><div class="op-detail-row"><span class="label">Strategy:</span> <span>Direct Mapping</span></div><div class="op-detail-row"><a href="https://www.tensorflow.org/api_docs/python/keras/layers/ReversibleEmbedding" target="_blank" class="op-doc-link">Official Docs ↗</a></div></div> 
      </div> 

      <!-- Load JS Logic only once per page ideally, but safe to exist globally --> 
      <script src="../_static/op_tabs.js"></script> 
    </div> 

