ml_switcheroo.frameworks.paxml
==============================

.. py:module:: ml_switcheroo.frameworks.paxml

.. autoapi-nested-parse::

   PaxML (Praxis) Framework Adapter (Level 2).

   This adapter specializes the core JAX stack for Google's PaxML framework, specifically
   targeting the **Praxis** layer library.

   It inherits Level 0 (Core JAX) and Level 1 (Optax/Orbax) capabilities from
   ``JAXStackMixin`` but implements the unique structural traits of the Praxis library,
   such as the ``setup()`` lifecycle method for layer definition.



Attributes
----------

.. autoapisummary::

   ml_switcheroo.frameworks.paxml.praxis


Classes
-------

.. autoapisummary::

   ml_switcheroo.frameworks.paxml.PaxmlAdapter


Module Contents
---------------

.. py:data:: praxis
   :value: None


.. py:class:: PaxmlAdapter

   Bases: :py:obj:`ml_switcheroo.frameworks.common.jax_stack.JAXStackMixin`


   Adapter for PaxML (Praxis Layers) running on JAX.

   Features:
   -   **Lifecycle Translation**: Maps standard ``__init__`` definitions to Praxis ``setup()`` methods.
   -   **Layer Mapping**: Maps Torch/Flax layers to ``praxis.layers.*``.
   -   **Stack Reuse**: Inherits optimization and math logic from the JAX Core adapter.


   .. py:attribute:: display_name
      :type:  str
      :value: 'PaxML / Praxis'



   .. py:attribute:: inherits_from
      :type:  str
      :value: 'jax'



   .. py:attribute:: ui_priority
      :type:  int
      :value: 60



   .. py:method:: collect_api(category: ml_switcheroo.frameworks.base.StandardCategory) -> List[ml_switcheroo.frameworks.base.GhostRef]

      Collects API definitions for the given category.

      Delegates to ``JaxCoreAdapter`` for Math, Loss, and Optimizer categories,
      while handling Layer discovery specifically for Praxis.

      :param category: The API category to scan.
      :type category: StandardCategory

      :returns: Found API signatures.
      :rtype: List[GhostRef]



   .. py:property:: search_modules
      :type: List[str]


      Returns list of modules to scan during manual scaffolding.

      :returns: Module names including ``praxis.layers`` and ``praxis.base_layer``.
      :rtype: List[str]


   .. py:property:: import_alias
      :type: Tuple[str, str]


      Returns the primary import alias for the framework.

      :returns: ``("praxis.layers", "pl")``.
      :rtype: Tuple[str, str]


   .. py:property:: import_namespaces
      :type: Dict[str, ml_switcheroo.frameworks.base.ImportConfig]


      Defines the semantic roles of Praxis namespaces.

      :returns: Mapping of namespaces to tiers.
      :rtype: Dict[str, ImportConfig]


   .. py:property:: discovery_heuristics
      :type: Dict[str, List[str]]


      Returns regex patterns for heuristic categorization.

      :returns: Patterns identifying neural components in Praxis.
      :rtype: Dict[str, List[str]]


   .. py:property:: test_config
      :type: Dict[str, str]


      Returns templates for generating physical test files.
      Extends the JAX base config with Praxis imports.

      :returns: Code generation templates.
      :rtype: Dict[str, str]


   .. py:property:: harness_imports
      :type: List[str]


      Returns imports required for the verification harness.

      :returns: ``['import jax', 'import jax.random']``.
      :rtype: List[str]


   .. py:method:: get_harness_init_code() -> str

      Returns Python code helper for initializing JAX random keys in the harness.

      :returns: Source code for ``_make_jax_key``.
      :rtype: str



   .. py:property:: supported_tiers
      :type: List[Any]


      Returns supported semantic tiers.

      :returns: Array API, Neural, and Extras.
      :rtype: List[SemanticTier]


   .. py:property:: declared_magic_args
      :type: List[str]


      Returns list of magic arguments to strip.
      Praxis usually handles RNG context internally or differently than Flax.

      :returns: Empty list.
      :rtype: List[str]


   .. py:property:: structural_traits
      :type: ml_switcheroo.frameworks.base.StructuralTraits


      Defines structural rewriting rules for Praxis.

      Key Differences:
      -   **Module Base**: ``praxis.base_layer.BaseLayer``.
      -   **Init Method**: Replaces ``__init__`` with ``setup``.
      -   **Super Init**: Disabled (not required in Praxis setup).

      :returns: The configuration object.
      :rtype: StructuralTraits


   .. py:property:: plugin_traits
      :type: ml_switcheroo.frameworks.base.PluginTraits


      Returns plugin capability flags.
      Enables functional control flow and purity analysis (inherited from JAX requirements).

      :returns: The capability flags.
      :rtype: PluginTraits


   .. py:property:: definitions
      :type: Dict[str, ml_switcheroo.frameworks.base.StandardMap]


      Returns static definitions for Praxis Layers.

      Maps standard Neural ops (Linear, Dropout, Embedding) to ``praxis.layers.*``
      and handles specific argument renaming (e.g. in_features -> input_dims).

      :returns: The mapping dictionary.
      :rtype: Dict[str, StandardMap]


   .. py:property:: rng_seed_methods
      :type: List[str]


      Returns list of global RNG seed methods (Empty for PaxML).

      :returns: Empty list.
      :rtype: List[str]


   .. py:method:: convert(data: Any) -> Any

      Converts input data to JAX arrays.

      :param data: Input data (numpy/list).
      :type data: Any

      :returns: JAX Array.
      :rtype: Any



   .. py:method:: apply_wiring(snapshot: Dict[str, Any]) -> None

      Applies JAX Stack wiring.

      Injects core JAX math operations and Optax optimizer mappings into the snapshot.

      :param snapshot: The snapshot dictionary to modify.
      :type snapshot: Dict[str, Any]



   .. py:method:: get_doc_url(api_name: str) -> Optional[str]

      Generates GitHub search URL for PaxML APIs since documentation is sparse.



   .. py:method:: get_example_code() -> str
      :classmethod:


      Returns default documentation example code.

      :returns: Neural Tier (Level 2) example.
      :rtype: str



   .. py:method:: get_tiered_examples() -> Dict[str, str]

      Returns tiered example code snippets for documentation.

      :returns: Mapping of tier IDs to code.
      :rtype: Dict[str, str]



