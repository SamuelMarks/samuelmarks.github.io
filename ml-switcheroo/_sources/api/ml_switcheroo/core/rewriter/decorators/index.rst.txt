ml_switcheroo.core.rewriter.decorators
======================================

.. py:module:: ml_switcheroo.core.rewriter.decorators

.. autoapi-nested-parse::

   Decorator Rewriting Mixin.

   This module provides logic to handle Python decorators (e.g., `@torch.jit.script`).
   It enables:

   1.  **Renaming**: Mapping decorators between frameworks (e.g., `@torch.jit.script` -> `@jax.jit`).
   2.  **Removal**: stripping decorators that have no equivalent in the target framework (if mapped to null).
   3.  **Trait-Based Handling**: Removes decorators marked as irrelevant by the target framework's traits,
       decoupling renaming logic from hardcoded framework strings.

   Logic robustness handles conflict with `CallMixin`. Since `leave_Decorator` runs
   after child nodes (the decorator expression) are visited, `CallMixin` might have
   already transformed calls inside the decorator (e.g. `@torch.jit.script(optk=True)`).
   To perform accurate lookups, we inspect the `original_node` (preserving Source semantics)
   before applying target logic.



Classes
-------

.. autoapisummary::

   ml_switcheroo.core.rewriter.decorators.DecoratorMixin


Module Contents
---------------

.. py:class:: DecoratorMixin(semantics: ml_switcheroo.semantics.manager.SemanticsManager, config: ml_switcheroo.config.RuntimeConfig, symbol_table: Optional[ml_switcheroo.analysis.symbol_table.SymbolTable] = None)

   Bases: :py:obj:`ml_switcheroo.core.rewriter.base.BaseRewriter`


   Mixin for transforming Decorator nodes.
   Part of PivotRewriter.


   .. py:method:: leave_Decorator(original_node: libcst.Decorator, updated_node: libcst.Decorator) -> Union[libcst.Decorator, libcst.RemovalSentinel]

      Processes decorators attached to functions or classes.

      Logic:

      1. Identifies the decorator name from `original_node` to ensure we key off the
         Source Framework API, even if `CallMixin` modified the children in `updated_node`.
      2. Looks up the semantic definition.
      3. Checks Target Structural Traits for explicit stripping requirements (e.g. `strip_decorators`).
      4. If the target variant is explicitly `null` (None), removes the decorator.
      5. If the target variant specifies a new API, rewrites the name.



