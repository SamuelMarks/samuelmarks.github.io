ml_switcheroo.frameworks.jax
============================

.. py:module:: ml_switcheroo.frameworks.jax

.. autoapi-nested-parse::

   JAX Core Framework Adapter (Level 0 & Level 1).

   This adapter provides support for the functional JAX ecosystem *without* binding
   to a high-level neural network library like Flax or Haiku. It maps:
   1.  **Level 0 (Core)**: JAX Array API (jnp), Activations (jax.nn), and Types.
   2.  **Level 1 (Common Libs)**: Optax (Optimization) and Orbax (Checkpointing).
   3.  **IO & Devices**: Handles `save`/`load` via Orbax and `jax.devices` mapping.

   It specifically enables `requires_explicit_rng` in plugin traits.



Attributes
----------

.. autoapisummary::

   ml_switcheroo.frameworks.jax.jax
   ml_switcheroo.frameworks.jax.JaxAdapter


Classes
-------

.. autoapisummary::

   ml_switcheroo.frameworks.jax.JaxCoreAdapter


Module Contents
---------------

.. py:data:: jax
   :value: None


.. py:class:: JaxCoreAdapter

   Bases: :py:obj:`ml_switcheroo.frameworks.common.jax_stack.JAXStackMixin`


   Adapter for Core JAX (jax + optax + orbax) without a Neural Framework.

   Handles translations for:
   -   **Math**: `jnp.abs`, `jnp.sum`, etc.
   -   **Types**: `jnp.float32`, `jnp.int32`, `jnp.bfloat16`.
   -   **Casting**: `.astype(...)` synthesis via plugins.
   -   **Optimization**: `optax.adam`, `optax.sgd`.


   .. py:attribute:: display_name
      :type:  str
      :value: 'JAX (Core)'



   .. py:attribute:: inherits_from
      :type:  Optional[str]
      :value: None



   .. py:attribute:: ui_priority
      :type:  int
      :value: 10



   .. py:property:: search_modules
      :type: List[str]


      Scans only core math and optimization libraries (no neural layers).

      :returns: List of module names.
      :rtype: List[str]


   .. py:property:: unsafe_submodules
      :type: Set[str]


      Returns a set of submodule names to exclude from recursive introspection.

      :returns: Explicitly empty set (safe to scan default paths).
      :rtype: Set[str]


   .. py:property:: import_alias
      :type: Tuple[str, str]


      Defines the canonical import alias ('jax.numpy', 'jnp').


   .. py:property:: import_namespaces
      :type: Dict[str, ml_switcheroo.frameworks.base.ImportConfig]


      Self-declared namespace roles.

      :returns: Map of paths to configuration.
      :rtype: Dict[str, ImportConfig]


   .. py:property:: discovery_heuristics
      :type: Dict[str, List[str]]


      Regex patterns for identifying API categories.

      :returns: Tier to regex patterns mapping.
      :rtype: Dict[str, List[str]]


   .. py:property:: test_config
      :type: Dict[str, str]


      Returns standard JIT-enabled test templates.


   .. py:property:: harness_imports
      :type: List[str]


      Imports required for JAX initialization logic.


   .. py:method:: get_harness_init_code() -> str

      Returns logic to create JAX PRNG Keys.



   .. py:property:: declared_magic_args
      :type: List[str]


      Returns `key` as a magic state argument.


   .. py:property:: structural_traits
      :type: ml_switcheroo.frameworks.base.StructuralTraits


      Defines JAX structural behavior (Transformation rules).
      Specifies JIT static arguments for compilation safety.

      :returns: Configuration object.
      :rtype: StructuralTraits


   .. py:property:: plugin_traits
      :type: ml_switcheroo.frameworks.base.PluginTraits


      Defines logic capabilities for plugins.
      Enables NumPy compatibility and explicit RNG threading.

      IMPORTANT: Enforces Purity Analysis to catch side-effects unsafe for functional trace.

      :returns: Configuration flags.
      :rtype: PluginTraits


   .. py:property:: rng_seed_methods
      :type: List[str]


      JAX does not use global seeding methods in the imperative sense.


   .. py:property:: definitions
      :type: Dict[str, ml_switcheroo.frameworks.base.StandardMap]


      Static Definitions for JAX Core, Optax, Orbax, and Types.
      Loaded dynamically from `frameworks/definitions/jax.json`.

      :returns: Mapping of definitions.
      :rtype: Dict[str, StandardMap]


   .. py:method:: collect_api(category: ml_switcheroo.frameworks.base.StandardCategory) -> List[ml_switcheroo.frameworks.base.GhostRef]

      Collects API signatures for discovering new Standards.
      Supports both Live introspection and Ghost Mode snapshots.

      :param category: Category to scan.
      :type category: StandardCategory

      :returns: Found API references.
      :rtype: List[GhostRef]



   .. py:method:: convert(data: Any) -> Any

      Converts input data to a JAX array for verification.

      :param data: Input data.
      :type data: Any

      :returns: JAX Array.
      :rtype: Any



   .. py:method:: apply_wiring(snapshot: Dict[str, Any]) -> None

      Applies Level 0/1 Stack wiring.
      Populates the JSON snapshot with manually wired logic.

      :param snapshot: The snapshot to modify.
      :type snapshot: Dict[str, Any]



   .. py:method:: get_example_code() -> str
      :classmethod:


      Returns a generic JAX example.

      :returns: Source code.
      :rtype: str



   .. py:method:: get_tiered_examples() -> Dict[str, str]

      Provides default tiered examples for the base adapter.

      :returns: Mapping of tier name to source code.
      :rtype: Dict[str, str]



   .. py:method:: get_doc_url(api_name: str) -> Optional[str]

      Generates JAX core documentation URL.

      :param api_name: API path.
      :type api_name: str

      :returns: URL string.
      :rtype: Optional[str]



.. py:data:: JaxAdapter

