ml_switcheroo.semantics.manager
===============================

.. py:module:: ml_switcheroo.semantics.manager

.. autoapi-nested-parse::

   SemanticsManager for Knowledge Base Loading and Updating.

   This module is responsible for locating, loading, and merging semantic
   specification files (JSONs) into a unified Knowledge Graph.

   It implements a "Hub-and-Spoke" loading strategy:
   1.  **Hub (Specs)**: Loads Abstract Operation definitions from `semantics/*.json`
       (e.g., `k_array_api.json`). These define the "Standard" (args, description).
   2.  **Spokes (Overlays)**: Scans `snapshots/*_mappings.json` to inject
       framework-specific implementation details (variants) into the abstract definitions.

   This separation allows the Specs to remain stable while Framework implementations
   evolve rapidly in the snapshots directory.



Attributes
----------

.. autoapisummary::

   ml_switcheroo.semantics.manager.files


Classes
-------

.. autoapisummary::

   ml_switcheroo.semantics.manager.SemanticsManager


Functions
---------

.. autoapisummary::

   ml_switcheroo.semantics.manager.resolve_semantics_dir
   ml_switcheroo.semantics.manager.resolve_snapshots_dir


Module Contents
---------------

.. py:data:: files
   :value: None


.. py:function:: resolve_semantics_dir() -> pathlib.Path

   Locates the directory containing semantic JSON definitions.

   Prioritizes the local file system (relative to this file) to ensure
   tests and editable installs find the source of truth correctly.
   Falls back to package resources for installed distributions.


.. py:function:: resolve_snapshots_dir() -> pathlib.Path

   Locates the directory containing framework snapshots and mapping overlays.
   Defaults to the sibling 'snapshots' directory relative to 'semantics'.


.. py:class:: SemanticsManager

   Central database for semantic mappings and configuration.

   Data Source Priority:
   1. Registry Defaults (Code-defined in FrameworkAdapters).
   2. Spec Files (`semantics/*.json`): Defines the Abstract Standards.
   3. Overlay Files (`snapshots/*_mappings.json`): Injects Framework Variants.


   .. py:attribute:: data
      :type:  Dict[str, Dict]


   .. py:attribute:: import_data
      :type:  Dict[str, Dict]


   .. py:attribute:: framework_configs
      :type:  Dict[str, Dict]


   .. py:attribute:: test_templates
      :type:  Dict[str, Dict]


   .. py:method:: get_all_rng_methods() -> Set[str]

      Returns the consolidated set of RNG methods from all frameworks.



   .. py:method:: resolve_variant(abstract_id: str, target_fw: str) -> Optional[Dict[str, Any]]

      Resolves the variant definition for a given target framework, traversing inheritance.
      Priority:
      1. JSON-Defined Inheritance (`__frameworks__` config).
      2. Code-Defined Inheritance (`FrameworkAdapter.inherits_from`).



   .. py:method:: load_validation_report(report_path: pathlib.Path) -> None


   .. py:method:: is_verified(abstract_id: str) -> bool


   .. py:method:: get_definition_by_id(abstract_id: str) -> Optional[Dict[str, Any]]


   .. py:method:: get_definition(api_name: str) -> Optional[Tuple[str, Dict]]


   .. py:method:: get_known_apis() -> Dict[str, Dict]


   .. py:method:: get_import_map(target_fw: str) -> Dict[str, Tuple[str, Optional[str], Optional[str]]]


   .. py:method:: get_framework_config(framework: str) -> Dict[str, Any]


   .. py:method:: get_test_template(framework: str) -> Optional[Dict[str, str]]


   .. py:method:: get_framework_aliases() -> Dict[str, Tuple[str, str]]


   .. py:method:: update_definition(abstract_id: str, new_data: Dict[str, Any]) -> None


