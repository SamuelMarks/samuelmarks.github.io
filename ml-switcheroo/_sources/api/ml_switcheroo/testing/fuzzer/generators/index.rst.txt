ml_switcheroo.testing.fuzzer.generators
=======================================

.. py:module:: ml_switcheroo.testing.fuzzer.generators

.. autoapi-nested-parse::

   Primitive Generation Logic for the Fuzzer.

   This module contains functions to generate random scalars, NumPy arrays,
   and dummy callables respecting specified constraints (min, max, dtype).



Functions
---------

.. autoapisummary::

   ml_switcheroo.testing.fuzzer.generators.generate_scalar_int
   ml_switcheroo.testing.fuzzer.generators.generate_scalar_float
   ml_switcheroo.testing.fuzzer.generators.generate_array
   ml_switcheroo.testing.fuzzer.generators.get_random_shape
   ml_switcheroo.testing.fuzzer.generators.generate_fake_callable


Module Contents
---------------

.. py:function:: generate_scalar_int(constraints: Dict[str, Any]) -> int

   Generates a random integer within constrained bounds.

   :param constraints: Dictionary containing optional 'min' and 'max'.
   :type constraints: Dict[str, Any]

   :returns: A random integer.
   :rtype: int


.. py:function:: generate_scalar_float(constraints: Dict[str, Any]) -> float

   Generates a random float within constrained bounds.

   :param constraints: Dictionary containing optional 'min' and 'max'.
   :type constraints: Dict[str, Any]

   :returns: A random float.
   :rtype: float


.. py:function:: generate_array(type_lbl: str, shape: Tuple[int, Ellipsis], constraints: Dict[str, Any]) -> numpy.ndarray

   Generates a random NumPy array bounded by constraints.

   :param type_lbl: General type category ('float', 'int', 'bool').
   :type type_lbl: str
   :param shape: The shape of the array.
   :type shape: Tuple[int, ...]
   :param constraints: Constraints like 'min', 'max', 'dtype'.
   :type constraints: Dict[str, Any]

   :returns: The generated array.
   :rtype: np.ndarray


.. py:function:: get_random_shape(seed_shape: Optional[Tuple[int, Ellipsis]] = None) -> Tuple[int, Ellipsis]

   Selects a random rank (1-4) and random dimensions (2-5).

   :param seed_shape: Optional fixed shape to return.
   :type seed_shape: Optional[Tuple]

   :returns: The random or seeded shape.
   :rtype: Tuple[int, ...]


.. py:function:: generate_fake_callable(constraints: Dict[str, Any] = None) -> Any

   Generates a dummy function (identity) for functional ops.

   This is critical for fuzzer verification of HOFs (Higher Order Functions)
   like `vmap`, `grad`, or `jit` which expect a callable input.

   The return value is a lambda that accepts any arguments and returns the first one.
   This ensures compatibility with unary ops (`f(x)`) and binary ops (`f(x, y)`).

   :param constraints: Unused, kept for API consistency.
   :type constraints: Dict[str, Any]

   :returns: A lambda function `lambda x, *args, **kwargs: x`.
   :rtype: Callable


