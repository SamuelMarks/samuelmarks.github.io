ml_switcheroo.plugins.gather
============================

.. py:module:: ml_switcheroo.plugins.gather

.. autoapi-nested-parse::

   Plugin for Gather Semantics Adaptation.

   Addresses the signature mismatch between:
   1. PyTorch: `torch.gather(input, dim, index, *, sparse_grad=False, out=None)`
   2. Target Framework (e.g. JAX/NumPy): `target.take_along_axis(arr, indices, axis)`

   Transformation:
   - Reorders positional arguments: `(input, dim, index)` -> `(input, index, dim)`.
   - Maps keyword arguments: `dim` -> `axis`, `index` -> `indices`.
   - Strips unsupported kwargs like `sparse_grad` or `out`.

   Decoupling Logic:
   - Removes hardcoded framework checks.
   - Strict lookup: If `Gather` is not mapped in semantics, preserves original call.



Functions
---------

.. autoapisummary::

   ml_switcheroo.plugins.gather.transform_gather


Module Contents
---------------

.. py:function:: transform_gather(node: libcst.Call, ctx: ml_switcheroo.core.hooks.HookContext) -> libcst.Call

   Hook: Adapts gather calls to take_along_axis semantics.

   Target API Convention: `func(input, indices, axis)`.
   Source (Torch) Convention: `func(input, dim, index)`.

   :param node: The original CST Call node.
   :param ctx: Hook Context containing semantic definitions.

   :returns: Transformed Call node if API mapping exists, else original node.


