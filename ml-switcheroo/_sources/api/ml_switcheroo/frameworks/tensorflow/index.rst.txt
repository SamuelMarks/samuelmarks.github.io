ml_switcheroo.frameworks.tensorflow
===================================

.. py:module:: ml_switcheroo.frameworks.tensorflow

.. autoapi-nested-parse::

   TensorFlow Framework Adapter.

   This module implements the adapter for TensorFlow (Core & Keras), providing
   mappings for math operations, neural layers, and IO. It serves as the bridge
   between abstract operations and ``tf.*`` or ``tf.keras.*`` APIs.

   It supports:
   1.  **Live Inspection**: Scanning installed TensorFlow modules for new operations.
   2.  **Ghost Mode**: Loading API signatures from JSON snapshots when TF is not installed.
   3.  **Semantic Definitions**: Static mappings for standard Math, NN, and Optimization ops.
   4.  **Weight Migration**: Loading checkpoints via ``tf.train.load_checkpoint``.



Attributes
----------

.. autoapisummary::

   ml_switcheroo.frameworks.tensorflow.tf


Classes
-------

.. autoapisummary::

   ml_switcheroo.frameworks.tensorflow.TensorFlowAdapter


Module Contents
---------------

.. py:data:: tf
   :value: None


.. py:class:: TensorFlowAdapter

   Adapter for TensorFlow (Core & Keras).

   Handles the specific idioms of TensorFlow 2.x, including:
   -   mapping ``torch.nn.Module`` to ``keras.Layer``.
   -   mapping ``torch.*`` math to ``tf.math.*``.
   -   mapping IO operations to ``tf.io.*``.


   .. py:attribute:: display_name
      :type:  str
      :value: 'TensorFlow'



   .. py:attribute:: inherits_from
      :type:  Optional[str]
      :value: None



   .. py:attribute:: ui_priority
      :type:  int
      :value: 30



   .. py:property:: unsafe_submodules
      :type: Set[str]


      Returns a set of submodule names to exclude from recursion.

      These modules often contain C-Extensions, deprecated logic, or
      heavy dependencies that crash the ``GhostInspector`` or cause
      infinite recursion during discovery.

      :returns: Blacklisted submodule names.
      :rtype: Set[str]


   .. py:property:: search_modules
      :type: List[str]


      Returns the list of top-level modules to scan during discovery.

      If in GHOST mode, returns an empty list to prevent import errors.

      :returns: Module names (e.g. ``['tensorflow', 'keras.layers']``).
      :rtype: List[str]


   .. py:property:: import_alias
      :type: Tuple[str, str]


      Returns the primary import statement configuration.

      :returns: The module name and its standard alias (e.g. ``('tensorflow', 'tf')``).
      :rtype: Tuple[str, str]


   .. py:property:: import_namespaces
      :type: Dict[str, ml_switcheroo.frameworks.base.ImportConfig]


      Defines the semantic roles of TensorFlow namespaces.

      This config guides the ``ImportFixer`` in resolving source imports
      to target imports based on their Semantic Tier.

      :returns: Mapping of namespace strings to configuration objects.
      :rtype: Dict[str, ImportConfig]


   .. py:property:: discovery_heuristics
      :type: Dict[str, List[str]]


      Returns regex patterns used to categorize discovered APIs.

      Used by the ``Scaffolder`` to blindly sort discovered functions into
      Math, Neural, or Extras tiers based on their path.

      :returns: Mapping of Tier names to regex patterns.
      :rtype: Dict[str, List[str]]


   .. py:property:: test_config
      :type: Dict[str, str]


      Returns templates for generating physical verification tests.

      These templates are used by ``gen-tests`` to create executable Python files
      that verify semantic correctness.

      :returns: Templates for imports and data conversion.
      :rtype: Dict[str, str]


   .. py:property:: harness_imports
      :type: List[str]


      Returns extra imports required for the verification harness.
      TensorFlow requires no special initialization imports beyond the standard test config.

      :returns: Empty list.
      :rtype: List[str]


   .. py:method:: get_harness_init_code() -> str

      Returns initialization logic for the verification harness.
      TensorFlow handles state implicitly, so no RNG setup code is needed.

      :returns: Empty string.
      :rtype: str



   .. py:method:: get_to_numpy_code() -> str

      Returns code to convert TF tensors to NumPy.

      :returns: Code string using safe attribute check.
      :rtype: str



   .. py:property:: declared_magic_args
      :type: List[str]


      Returns list of framework-specific 'magic' arguments to be stripped from other frameworks.
      TensorFlow generally uses explicit arguments or class attributes, not injected magic args.

      :returns: Empty list.
      :rtype: List[str]


   .. py:property:: structural_traits
      :type: ml_switcheroo.frameworks.base.StructuralTraits


      Returns structural transformation rules for TensorFlow/Keras.

      Defines how classes should be rewritten (e.g. inheriting from ``keras.Layer``),
      what the forward method is named (``call``), and initialization requirements.

      :returns: The configuration object.
      :rtype: StructuralTraits


   .. py:property:: plugin_traits
      :type: ml_switcheroo.frameworks.base.PluginTraits


      Returns capability flags for the TensorFlow ecosystem.

      Indicates support for NumPy-compatible methods (allowing ``.astype`` via ops)
      but lack of functional state requirements.

      :returns: The capability flags.
      :rtype: PluginTraits


   .. py:property:: supported_tiers
      :type: List[ml_switcheroo.enums.SemanticTier]


      Returns the Semantic Tiers supported by this adapter.

      :returns: Array API, Neural, and Extras.
      :rtype: List[SemanticTier]


   .. py:property:: definitions
      :type: Dict[str, ml_switcheroo.frameworks.base.StandardMap]


      Returns the static dictionary of Operation Mappings.
      Loaded dynamically from `frameworks/definitions/tensorflow.json`.

      :returns: The mapping dictionary.
      :rtype: Dict[str, StandardMap]


   .. py:property:: rng_seed_methods
      :type: List[str]


      Returns list of methods used to set global random seeds.
      Used by the PurityScanner to detect side-effects.

      :returns: Method names (e.g. ``set_seed``).
      :rtype: List[str]


   .. py:method:: collect_api(category: ml_switcheroo.frameworks.base.StandardCategory) -> List[ml_switcheroo.core.ghost.GhostRef]

      Collects API definitions for the discovery process.

      Delegates to ``_collect_ghost`` if in Ghost Mode, otherwise runs
      ``_collect_live`` to inspect the installed library.

      :param category: The category of operations to scan (e.g. LOSS, LAYER).
      :type category: StandardCategory

      :returns: A list of discovered API signatures.
      :rtype: List[GhostRef]



   .. py:method:: apply_wiring(snapshot: Dict[str, Any]) -> None

      Applies manual wiring patches to the generated snapshot.
      TensorFlow currently requires no manual wiring corrections.

      :param snapshot: The snapshot dictionary to modify in-place.
      :type snapshot: Dict[str, Any]



   .. py:method:: get_example_code() -> str
      :classmethod:


      Returns the primary example code used for documentation.

      :returns: The Neural Tier (Tier 2) example code.
      :rtype: str



   .. py:method:: get_tiered_examples() -> Dict[str, str]

      Returns example snippets for each semantic tier.

      Used by the interactive web demo and documentation generator.

      :returns: Mapping of tier IDs to Python code strings.
      :rtype: Dict[str, str]



   .. py:method:: get_device_syntax(device_type: str, device_index: Optional[str] = None) -> str

      Generates Python code for defining a device context in TensorFlow.

      Example: ``tf.device('GPU:0')``

      :param device_type: The device type string (e.g. 'cuda', 'cpu').
      :type device_type: str
      :param device_index: The device index.
      :type device_index: Optional[str]

      :returns: Arguments for ``tf.device(...)``.
      :rtype: str



   .. py:method:: get_device_check_syntax() -> str

      Returns Python code to check for GPU availability.

      :returns: ``len(tf.config.list_physical_devices('GPU')) > 0``
      :rtype: str



   .. py:method:: get_rng_split_syntax(rng_var: str, key_var: str) -> str

      Returns syntax for splitting RNG state.
      Since TF uses internal state, this returns 'pass' (no-op).

      :param rng_var: Variable name for current RNG.
      :type rng_var: str
      :param key_var: Variable name for new key.
      :type key_var: str

      :returns: "pass"
      :rtype: str



   .. py:method:: get_serialization_imports() -> List[str]

      Returns imports required for IO operations.

      :returns: ``['import tensorflow as tf']``
      :rtype: List[str]



   .. py:method:: get_serialization_syntax(op: str, file_arg: str, object_arg: Optional[str] = None) -> str

      Generates code for saving or loading artifacts.

      :param op: Operation type ('save' or 'load').
      :type op: str
      :param file_arg: Path to file.
      :type file_arg: str
      :param object_arg: Object to save.
      :type object_arg: Optional[str]

      :returns: Generated code (e.g. ``tf.io.write_file``).
      :rtype: str



   .. py:method:: get_weight_conversion_imports() -> List[str]

      Returns imports required for the generated weight migration script.

      :returns: List of import statements.
      :rtype: List[str]



   .. py:method:: get_weight_load_code(path_var: str) -> str

      Returns Python code to load a TF checkpoint into a raw dict found in `raw_state`.
      Attempt to load variable map if available.

      :param path_var: Variable name containing file path.

      :returns: Code block string.



   .. py:method:: get_tensor_to_numpy_expr(tensor_var: str) -> str

      Returns expression to convert a TF tensor to a NumPy array.

      :param tensor_var: Variable name of the tensor.

      :returns: Conversion expression string.



   .. py:method:: get_weight_save_code(state_var: str, path_var: str) -> str

      Returns logic (stubbed with warning) for saving weights.
      TensorFlow checkpoint saving generally requires a model instance structure,
      so raw dictionary saving is not supported in the standalone migration script.

      :param state_var: Unused state variable name.
      :param path_var: Unused path variable name.

      :returns: Warning print code.



   .. py:method:: convert(data: Any) -> Any

      Converts input data (NumPy/List) into TensorFlow Tensors.
      Used by the Fuzzer for validation.

      :param data: Input data.
      :type data: Any

      :returns: ``tf.Tensor`` or original data if conversion fails.
      :rtype: Any



   .. py:method:: get_doc_url(api_name: str) -> Optional[str]

      Generates TensorFlow API documentation URL.
      Corrects internal `tensorflow` path to `tf` for doc references.

      :param api_name: API Path.
      :type api_name: str

      :returns: URL.
      :rtype: Optional[str]



