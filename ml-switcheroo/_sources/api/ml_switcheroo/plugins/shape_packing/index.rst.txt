ml_switcheroo.plugins.shape_packing
===================================

.. py:module:: ml_switcheroo.plugins.shape_packing

.. autoapi-nested-parse::

   Plugin for Packing Shape Arguments.

   This transformation converts variable-argument shape definitions into
   explicit tuple arguments required by certain frameworks.

   .. rubric:: Example

   Source: `x.view(1, 2, -1)` (PyTorch style)
   Target: `jnp.reshape(x, (1, 2, -1))` (JAX/NumPy style)

   Decoupling Logic:
       This plugin does NOT enforce a framework whitelist. It executes unconditionally
       if wired. However, it relies on looking up "Reshape" or "View" in the semantics.
       If those definitions are missing for the target framework, it aborts.



Functions
---------

.. autoapisummary::

   ml_switcheroo.plugins.shape_packing.transform_shape_packing


Module Contents
---------------

.. py:function:: transform_shape_packing(node: libcst.Call, ctx: ml_switcheroo.core.hooks.HookContext) -> libcst.Call

   Hook: Packs trailing positional arguments into a shape tuple.

   Logic:
   1.  Resolve Target API via "Reshape" or "View". Abort if missing.
   2.  Packs arguments.

   :param node: The original CST Call node.
   :param ctx: The hook execution context.

   :returns: The transformed call with packed shape arguments.
   :rtype: cst.Call


