place
=====

Update array elements based on a mask.

JAX implementation of :func:`numpy.place`.

The semantics of :func:`numpy.place` are to modify arrays in-place, which
is not possible for JAX's immutable arrays. The JAX version returns a modified
copy of the input, and adds the ``inplace`` parameter which must be set to
`False`` by the user as a reminder of this API difference.

Args:
  arr: array into which values will be placed.
  mask: boolean mask with the same size as ``arr``.
  vals: values to be inserted into ``arr`` at the locations indicated
    by mask. If too many values are supplied, they will be truncated.
    If not enough values are supplied, they will be repeated.
  inplace: must be set to False to indicate that the input is not modified
    in-place, but rather a modified copy is returned.

Returns:
  A copy of ``arr`` with masked values set to entries from `vals`.

See Also:
  - :func:`jax.numpy.put`: put elements into an array at numerical indices.
  - :func:`jax.numpy.ndarray.at`: array updates using NumPy-style indexing

Examples:
  >>> x = jnp.zeros((3, 5), dtype=int)
  >>> mask = (jnp.arange(x.size) % 3 == 0).reshape(x.shape)
  >>> mask
  Array([[ True, False, False,  True, False],
         [False,  True, False, False,  True],
         [False, False,  True, False, False]], dtype=bool)

  Placing a scalar value:

  >>> jnp.place(x, mask, 1, inplace=False)
  Array([[1, 0, 0, 1, 0],
         [0, 1, 0, 0, 1],
         [0, 0, 1, 0, 0]], dtype=int32)

  In this case, ``jnp.place`` is similar to the masked array update syntax:

  >>> x.at[mask].set(1)
  Array([[1, 0, 0, 1, 0],
         [0, 1, 0, 0, 1],
         [0, 0, 1, 0, 0]], dtype=int32)

  ``place`` differs when placing values from an array. The array is repeated
  to fill the masked entries:

  >>> vals = jnp.array([1, 3, 5])
  >>> jnp.place(x, mask, vals, inplace=False)
  Array([[1, 0, 0, 3, 0],
         [0, 5, 0, 0, 1],
         [0, 0, 3, 0, 0]], dtype=int32)

**Abstract Signature:**

``place(arr, mask, vals, inplace)``

.. raw:: html

 
    <div class="op-tabs-container"> 
      <div class="op-tabs-nav"> 
        <button class="op-tab-btn active" onclick="openOpTab(event, 'JAX (Core)_0')">JAX (Core)</button><button class="op-tab-btn " onclick="openOpTab(event, 'Flax NNX_1')">Flax NNX</button> 
      </div> 
      <div class="op-tabs-content"> 
        <div id="JAX (Core)_0" class="op-tab-pane active"><h4>JAX (Core)</h4><div class="op-detail-row"><span class="label">API:</span> <code>jax.numpy.place</code></div><div class="op-detail-row"><span class="label">Strategy:</span> <span>Direct Mapping</span></div><div class="op-detail-row"><a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.place.html" target="_blank" class="op-doc-link">Official Docs ↗</a></div></div><div id="Flax NNX_1" class="op-tab-pane "><h4>Flax NNX</h4><div class="op-detail-row"><span class="label">API:</span> <code>jax.numpy.place</code></div><div class="op-detail-row"><span class="label">Strategy:</span> <span>Direct Mapping</span></div><div class="op-detail-row"><a href="https://flax.readthedocs.io/en/latest/search.html?q=jax.numpy.place" target="_blank" class="op-doc-link">Official Docs ↗</a></div></div> 
      </div> 

      <!-- Load JS Logic only once per page ideally, but safe to exist globally --> 
      <script src="../_static/op_tabs.js"></script> 
    </div> 

